/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/events/jquery/EventTriggerHook","sap/base/Log","sap/ui/core/Lib","sap/ui/thirdparty/jquery"],function(e,t,i,a){"use strict";var r={},n=["focusin","focusout","keydown","keypress","keyup","mousedown","touchstart","touchmove","mouseup","touchend","click"],o=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr|tr)$/i;r.block=function(e,i,r){var n,u,c,d;if(e){n=e.getDomRef(r);if(!n){n=e.getDomRef()}if(!n){t.warning("BlockLayer could not be rendered. The outer Control instance is not valid anymore or was not rendered yet.");return}u=n.tagName;if(o.test(u)){t.warning("BusyIndicator cannot be placed in elements with tag '"+u+"'.");return}d=s(n,i);c={$parent:a(n),$blockLayer:a(d),control:e};if(c.$parent.css("position")=="static"){if(n.style&&n.style.position==="static"){c.originalPosition="static"}c.$parent.css("position","relative");c.positionChanged=true}l.call(c,true)}else{t.warning("BlockLayer couldn't be created. No Control instance given.")}return c};r.unblock=function(e){if(e){if(e.originalPosition){e.$parent.css("position",e.originalPosition)}else if(e.positionChanged){e.$parent.css("position","")}l.call(e,false);if(e.control&&e.$blockLayer[0]&&e.$blockLayer[0].contains(document.activeElement)){e.control.focus()}e.$blockLayer.remove()}};r.addAriaAttributes=function(e){var t=i.get("sap.ui.core").getResourceBundle();e.setAttribute("role","progressbar");e.setAttribute("aria-valuemin","0");e.setAttribute("aria-valuemax","100");e.setAttribute("aria-valuetext",t.getText("BUSY_VALUE_TEXT"));e.setAttribute("alt","");e.setAttribute("tabindex","0");e.setAttribute("title",t.getText("BUSY_TEXT"))};r.toggleAnimationStyle=function(e,t){var i=a(e.$blockLayer.get(0));if(t){i.removeClass("sapUiHiddenBusyIndicatorAnimation");i.removeClass("sapUiBlockLayerOnly")}else{i.addClass("sapUiBlockLayerOnly");i.addClass("sapUiHiddenBusyIndicatorAnimation")}};function s(e,t){var i=document.createElement("div");i.id=t;i.className="sapUiBlockLayer ";r.addAriaAttributes(i);e.appendChild(i);return i}function l(i){if(i){var a=this.$parent.get(0);if(a){this.fnRedirectFocus=o.bind(this);this.oTabbableBefore=s(this.fnRedirectFocus);this.oTabbableAfter=s(this.fnRedirectFocus);a.parentNode.insertBefore(this.oTabbableBefore,a);a.parentNode.insertBefore(this.oTabbableAfter,a.nextSibling);this._fnSuppressDefaultAndStopPropagationHandler=r.bind(this);this._aSuppressHandler=u.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}else{t.warning("fnHandleInteraction called with bEnabled true, but no DOMRef exists!")}}else{if(this.oTabbableBefore){l(this.oTabbableBefore,this.fnRedirectFocus);delete this.oTabbableBefore}if(this.oTabbableAfter){l(this.oTabbableAfter,this.fnRedirectFocus);delete this.oTabbableAfter}delete this.fnRedirectFocus;c.call(this,this._fnSuppressDefaultAndStopPropagationHandler)}function r(e){var i=e.target===this.$blockLayer.get(0),a;if(i&&e.type==="keydown"&&e.keyCode===9){t.debug("Local Busy Indicator Event keydown handled: "+e.type);a=e.shiftKey?this.oTabbableBefore:this.oTabbableAfter;a.setAttribute("tabindex",-1);this.bIgnoreFocus=true;a.focus();this.bIgnoreFocus=false;a.setAttribute("tabindex",0);e.stopImmediatePropagation()}else if(i&&(e.type==="mousedown"||e.type==="touchstart")){t.debug("Local Busy Indicator click handled on busy area: "+e.target.id);e.stopImmediatePropagation()}else{t.debug("Local Busy Indicator Event Suppressed: "+e.type);e.preventDefault();e.stopImmediatePropagation()}}function o(){if(!this.bIgnoreFocus){this.$blockLayer.get(0).focus()}}function s(e){var t=document.createElement("span");t.setAttribute("tabindex",0);t.classList.add("sapUiBlockLayerTabbable");t.addEventListener("focusin",e);return t}function l(e,t){if(e.parentNode){e.parentNode.removeChild(e)}e.removeEventListener("focusin",t)}function u(t){var i=[],a=this.$parent.get(0),r=this.$blockLayer.get(0);for(var o=0;o<n.length;o++){a.addEventListener(n[o],t,{capture:true,passive:false});i.push(e.suppress(n[o],a,r))}this.$blockLayer.on("keydown",t);return i}function c(t){var i,a=this.$parent.get(0),r=this.$blockLayer.get(0);if(a){for(i=0;i<n.length;i++){a.removeEventListener(n[i],t,{capture:true,passive:false})}}if(this._aSuppressHandler){for(i=0;i<this._aSuppressHandler.length;i++){e.release(this._aSuppressHandler[i])}}if(r){this.$blockLayer.off("keydown",t)}}}return r});